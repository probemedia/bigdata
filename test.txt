
# 1999~2020까지 CH4배출량의 결측치 처리후 시계열 그래프 작성
# 선형보간법을 사용한 결측치 처리
install.packages("forecast")
library(forecast)

df2 <- df_ghgs1[, 2:4]
df2$CO2_ppm <- na.interp(df2$CO2_ppm)
df2$CO2_ppm <- as.numeric(df2$CO2_ppm)
df2$CH4_ppm <- na.interp(df2$CH4_ppm)
df2$CH4_ppm <- as.numeric(df2$CH4_ppm)

# 결측치 없는 df2데이터프레임 생성

head(df2)

# df2을 사용한 1999~2020까지 CH4배출량 추이 시계열 그래프
df2 %>% ggplot(aes(x=시간, y=CH4_ppm)) + geom_line()

library(forecast)
df_ghgs <- read.csv("data/1999-2020_ghgs.csv")

# df_ghgs의 복제본 df_ghgs1 생성
df_ghgs1 <- df_ghgs

# 문자열로 로드된 시간변수를 날짜타입으로 변환
df_ghgs1$시간 <- as.Date(df_ghgs1$시간)
df_ghgs1
df3 <- df_ghgs1[, 2:5]
# 선형보간법을 사용한 결측치 처리
df3$CO2_ppm <- na.interp(df3$CO2_ppm)
df3$CO2_ppm <- as.numeric(df3$CO2_ppm)
df3$N2O_ppm <- na.interp(df3$N2O_ppm)
df3$N2O_ppm <- as.numeric(df3$N2O_ppm)

# 결측치 없는 df3데이터프레임 생성
head(df3)

# df3을 사용한 1999~2020까지 N2O배출량 추이 시계열 그래프
df3 %>% ggplot(aes(x=시간, y=N2O_ppm)) + geom_line()
